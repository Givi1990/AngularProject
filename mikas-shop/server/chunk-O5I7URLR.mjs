import './polyfills.server.mjs';
import{a as P,b as S,c as O,d as R,e as E,g,i as H,k as G,m as j,s as D,t as q}from"./chunk-YNXGCIQP.mjs";import{$ as T,E as x,F as b,J as M,U as m,V as h,Xa as N,_ as C,aa as f,ca as d,ea as r,fa as n,ga as p,ha as F,ia as w,ja as u,qa as l,r as I,sb as V,u as L,z as k}from"./chunk-JUVFFZCQ.mjs";var z=(()=>{let o=class o{constructor(t){this.containerRef=t}openModal(t){o.modalContainer=this.containerRef.createComponent(t)}closeModal(){o.modalContainer.destroy()}};o.\u0275fac=function(e){return new(e||o)(L(C))},o.\u0275prov=I({token:o,factory:o.\u0275fac,providedIn:"root"});let i=o;return i})();function U(i,o){i&1&&(r(0,"span",32),l(1,"Mandatory filling."),n())}function J(i,o){i&1&&(r(0,"span",33),l(1,"Mandatory filling."),n())}function W(i,o){i&1&&(r(0,"span",34),l(1,"Password must start with an uppercase letter."),n())}function Y(i,o){i&1&&(r(0,"span",35),l(1,"Mandatory filling."),n())}function B(i,o){i&1&&(r(0,"span",36),l(1,"Mandatory filling."),n())}function K(i,o){i&1&&(r(0,"span",36),l(1,"Mandatory filling."),n())}function Q(i,o){i&1&&(r(0,"span",37),l(1,"Mandatory filling."),n())}function X(i,o){if(i&1){let s=F();r(0,"div",5)(1,"button",6),w("click",function(){x(s);let e=u();return b(e.closeLoginModal())}),p(2,"i",7),n(),r(3,"form",8)(4,"div",9)(5,"label",10),l(6,"User Name"),n(),p(7,"input",11),f(8,U,2,0,"span",12),n(),r(9,"div",9)(10,"label",13),l(11,"Email"),n(),p(12,"input",14),f(13,J,2,0,"span",15),n(),r(14,"div",9)(15,"label",16),l(16,"Password"),n(),p(17,"input",17),f(18,W,2,0,"span",18)(19,Y,2,0,"span",19),n(),r(20,"div",9)(21,"label",20),l(22,"City"),n(),p(23,"input",21),f(24,B,2,0,"span",22),n(),r(25,"div",9)(26,"label",23),l(27,"Address"),n(),p(28,"input",24),f(29,K,2,0,"span",22),n(),r(30,"div",9)(31,"label",25),l(32,"Phone Number"),n(),p(33,"input",26),f(34,Q,2,0,"span",27),n(),p(35,"br"),r(36,"button",28),w("click",function(){x(s);let e=u();return b(e.registration())}),l(37,"Submit"),n(),r(38,"div",29)(39,"p",30),l(40,"You already have an account? "),r(41,"a",31),w("click",function(){x(s);let e=u();return b(e.goToRegistr())}),l(42,"Log in"),n()()()()()}if(i&2){let s,t,e,c,_,v,y,a=u();m(3),d("formGroup",a.registrationForm),m(5),d("ngIf",((s=a.registrationForm.get("username"))==null?null:s.dirty)&&((s=a.registrationForm.get("username"))==null||s.errors==null?null:s.errors.required)),m(5),d("ngIf",((t=a.registrationForm.get("email"))==null?null:t.dirty)&&((t=a.registrationForm.get("email"))==null||t.errors==null?null:t.errors.required)),m(5),d("ngIf",((e=a.registrationForm.get("password"))==null?null:e.dirty)&&((e=a.registrationForm.get("password"))==null||e.errors==null?null:e.errors.firstLetterUpperCase)),m(),d("ngIf",((c=a.registrationForm.get("password"))==null?null:c.dirty)&&((c=a.registrationForm.get("password"))==null||c.errors==null?null:c.errors.required)),m(5),d("ngIf",((_=a.registrationForm.get("city"))==null?null:_.dirty)&&((_=a.registrationForm.get("city"))==null||_.errors==null?null:_.errors.required)),m(5),d("ngIf",((v=a.registrationForm.get("address"))==null?null:v.dirty)&&((v=a.registrationForm.get("address"))==null||v.errors==null?null:v.errors.required)),m(5),d("ngIf",((y=a.registrationForm.get("phone"))==null?null:y.dirty)&&((y=a.registrationForm.get("phone"))==null||y.errors==null?null:y.errors.required)),m(2),d("disabled",a.registrationForm.invalid)}}function Z(i,o){if(i&1){let s=F();r(0,"div",38)(1,"button",6),w("click",function(){x(s);let e=u();return b(e.closeLoginModal())}),p(2,"i",7),n(),r(3,"form",8)(4,"div",9)(5,"label",39),l(6,"Email address"),n(),p(7,"input",40),n(),r(8,"div",9)(9,"label",41),l(10,"Password"),n(),p(11,"input",42),n(),p(12,"br"),r(13,"button",43),w("click",function(){x(s);let e=u();return b(e.login())}),l(14,"Submit"),n(),r(15,"div",29)(16,"p",30),l(17,"Don't have an account? "),r(18,"a",31),w("click",function(){x(s);let e=u();return b(e.goToRegistr())}),l(19," Register"),n()()()()()}if(i&2){let s=u();m(3),d("formGroup",s.loginForm)}}var de=(()=>{let o=class o extends z{constructor(t,e,c,_){super(c),this.router=t,this.http=e,this.cookieService=_,this.gotoRegGoToLog=!0,this.userName=new M,this.containerRef=c}ngOnInit(){this.initForm()}initForm(){this.registrationForm=new E({username:new g(""),email:new g(""),password:new g(""),city:new g(""),address:new g(""),phone:new g("")}),this.loginForm=new E({usernameLog:new g("",[S.required]),passwordLog:new g("",[S.required])})}registration(){let t=new FormData;t.append("id",""),t.append("username",this.registrationForm.get("username")?.value),t.append("email",this.registrationForm.get("email")?.value),t.append("password",this.registrationForm.get("password")?.value),t.append("city",this.registrationForm.get("city")?.value),t.append("address",this.registrationForm.get("address")?.value),t.append("phone",this.registrationForm.get("phone")?.value),console.log("regist",t),this.http.setAPINewUser(t).subscribe(e=>{e&&(localStorage.setItem("token",e.token),console.log(e.token),localStorage.setItem("user",JSON.stringify(e.user)),this.userInfo=e.user,localStorage.setItem("user",JSON.stringify(this.userInfo)))},e=>console.error("Error:",e)),setTimeout(()=>{this.router.navigate(["..shell/catalogue"]),this.closeModal(),this.relodadWindow()},2e3)}login(){let t=new FormData;t.append("username",this.loginForm.get("usernameLog")?.value),t.append("password",this.loginForm.get("passwordLog")?.value),this.http.setAPIUsers(t).subscribe(e=>{localStorage.setItem("token",e.token),localStorage.setItem("user",JSON.stringify(e.user)),setTimeout(()=>{this.closeModal(),this.relodadWindow()},1e3)},e=>console.error("Error:",e))}relodadWindow(){window.location.reload()}goToRegistr(){typeof window<"u"&&(this.gotoRegGoToLog=!this.gotoRegGoToLog)}closeLoginModal(){this.closeModal()}};o.\u0275fac=function(e){return new(e||o)(h(V),h(q),h(C),h(D))},o.\u0275cmp=k({type:o,selectors:[["app-login"]],outputs:{userName:"userName"},features:[T],decls:5,vars:2,consts:[["id","exampleModal","tabindex","-1","aria-hidden","true",1,"modal",2,"border","none","background-color","rgba(128, 128, 128, 0.241)"],["role","document",1,"modal-dialog",2,"border","none","border-radius","none!important"],[1,"modal-content",2,"border","none","border-radius","none!important"],["class","col-4","style","border-radius: none!important;",4,"ngIf"],["class","col-4",4,"ngIf"],[1,"col-4",2,"border-radius","none!important"],[1,"closeModal",3,"click"],[1,"bi","bi-x-lg"],["autocomplete","on",3,"formGroup"],[1,"form-group"],["for","username"],["type","text","id","username","formControlName","username","autocomplete","username",1,"form-control"],["id","usernameHelp","class","error-text",4,"ngIf"],["for","email"],["type","email","id","email","formControlName","email","autocomplete","email",1,"form-control"],["id","emailHelp","class","error-text",4,"ngIf"],["for","password"],["type","password","id","password","formControlName","password","autocomplete","current-password",1,"form-control"],["id","passHelp","class","error-text",4,"ngIf"],["id","passHelp2","class","error-text",4,"ngIf"],["for","city"],["type","text","id","city","formControlName","city","autocomplete","city",1,"form-control"],["id","addressHelp","class","error-text",4,"ngIf"],["for","address"],["type","text","id","address","formControlName","address","autocomplete","address",1,"form-control"],["for","phone"],["type","text","id","number","formControlName","phone","autocomplete","email",1,"form-control"],["id","phoneHelp","class","error-text",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"click","disabled"],[1,"agree-submit"],[2,"font-size","0.8rem"],[2,"color","blue","text-decoration","underline","font-size","0.8rem",3,"click"],["id","usernameHelp",1,"error-text"],["id","emailHelp",1,"error-text"],["id","passHelp",1,"error-text"],["id","passHelp2",1,"error-text"],["id","addressHelp",1,"error-text"],["id","phoneHelp",1,"error-text"],[1,"col-4"],["for","usernameLog"],["type","email","id","usernameLog","formControlName","usernameLog","autocomplete","usernameLog",1,"form-control"],["for","passwordLog"],["type","password","id","passwordLog","formControlName","passwordLog","autocomplete","password",1,"form-control"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,c){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),f(3,X,43,9,"div",3)(4,Z,20,1,"div",4),n()()()),e&2&&(m(3),d("ngIf",!c.gotoRegGoToLog),m(),d("ngIf",c.gotoRegGoToLog))},dependencies:[N,H,P,O,R,G,j],styles:['*[_ngcontent-%COMP%]{font-family:Open Sans,"sans-serif",FontAwesome}.col-4[_ngcontent-%COMP%]{width:auto;min-width:380px;background-color:#ffffff91;padding:30px;border-radius:0;box-sizing:border-box;box-shadow:2px 4px 7px -1px #0000005e;border:none}.error-text[_ngcontent-%COMP%]{color:red;font-weight:200;font-size:12px;display:block;box-sizing:border-box}.radio[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:20px;justify-content:center;box-sizing:border-box}.agree-submit[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:30px;justify-content:end;box-sizing:border-box}.form-check[_ngcontent-%COMP%]{margin-right:20px;box-sizing:border-box}.modal[_ngcontent-%COMP%]{display:block;border:none}.closeModal[_ngcontent-%COMP%]{border:none;background-color:#fff;margin-left:90%}.bd-example-modal-lg[_ngcontent-%COMP%]{width:28rem}']});let i=o;return i})();export{z as a,de as b};
